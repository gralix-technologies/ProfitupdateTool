import{r as c,j as e}from"./app-BkeQkwCz.js";import{A as w,g as x,b as h,a as I,d as E,c as _}from"./AppLayout-QgBVyLMh.js";import{I as z}from"./IconDownload-DpSVhOrW.js";import{I as C}from"./IconRefresh-U6chIQJB.js";import{I as S}from"./IconSearch-qzSKrpRq.js";import{I as A}from"./IconCalendar-C52FWICz.js";import{I as L}from"./IconEye-BLMw8FPn.js";import{I as T}from"./IconTrash-DY-55J-g.js";import{I as k}from"./IconPlus-Cs3MX6an.js";function G({auditLogs:d,totalLogs:o,auth:D}){const[a,j]=c.useState(""),[l,u]=c.useState(""),[r,v]=c.useState(d||[]);c.useEffect(()=>{let s=d||[];a&&(s=s.filter(t=>{var i,n,m;return((i=t.user_name)==null?void 0:i.toLowerCase().includes(a.toLowerCase()))||((n=t.event)==null?void 0:n.toLowerCase().includes(a.toLowerCase()))||((m=t.auditable_type)==null?void 0:m.toLowerCase().includes(a.toLowerCase()))})),l&&(s=s.filter(t=>t.event===l)),v(s)},[a,l,d]);const N=s=>{switch(s){case"created":return"success";case"updated":return"warning";case"deleted":return"danger";default:return"secondary"}},p=s=>s?s.split("\\").pop():"Unknown",b=s=>{switch(s){case"created":return e.jsx(k,{size:16});case"updated":return e.jsx(_,{size:16});case"deleted":return e.jsx(T,{size:16});default:return e.jsx(E,{size:16})}},f=s=>new Date(s).toLocaleString(),y=()=>{console.log("Export audit logs")},g=()=>{window.location.reload()};return e.jsxs(w,{title:"System Logs",children:[e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row g-2 align-items-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"page-pretitle",children:"Admin"}),e.jsx("h2",{className:"page-title",children:"System Audit Logs"})]}),e.jsx("div",{className:"col-auto ms-auto d-print-none",children:e.jsxs("div",{className:"btn-list",children:[e.jsxs("button",{className:"btn btn-outline-primary",onClick:y,children:[e.jsx(z,{size:16,className:"me-1"}),"Export"]}),e.jsxs("button",{className:"btn btn-primary",onClick:g,children:[e.jsx(C,{size:16,className:"me-1"}),"Refresh"]})]})})]})})}),e.jsx("div",{className:"page-body",children:e.jsxs("div",{className:"container-xl",children:[e.jsxs("div",{className:"row row-deck row-cards mb-3",children:[e.jsx("div",{className:"col-sm-6 col-lg-3",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"subheader",children:"Total Logs"}),e.jsx("div",{className:"ms-auto",children:e.jsx(x,{size:24,className:"text-primary"})})]}),e.jsx("div",{className:"h1 mb-3",children:o||0}),e.jsx("div",{className:"d-flex mb-2",children:e.jsx("div",{className:"text-muted",children:"Audit entries"})})]})})}),e.jsx("div",{className:"col-sm-6 col-lg-3",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"subheader",children:"Recent Activity"}),e.jsx("div",{className:"ms-auto",children:e.jsx(h,{size:24,className:"text-success"})})]}),e.jsx("div",{className:"h1 mb-3",children:r.length}),e.jsx("div",{className:"d-flex mb-2",children:e.jsx("div",{className:"text-muted",children:"Filtered results"})})]})})})]}),e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Filter Audit Logs"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx(S,{size:16})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by user, event, or model...",value:a,onChange:s=>j(s.target.value)})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Event Type"}),e.jsxs("select",{className:"form-select",value:l,onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"",children:"All Events"}),e.jsx("option",{value:"created",children:"Created"}),e.jsx("option",{value:"updated",children:"Updated"}),e.jsx("option",{value:"deleted",children:"Deleted"})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Audit Trail"})}),e.jsx("div",{className:"card-body",children:r.length>0?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-vcenter card-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Event"}),e.jsx("th",{children:"Model"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Changes"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(I,{size:16,className:"me-2 text-muted"}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:s.user_name}),s.user_email&&e.jsx("div",{className:"text-muted small",children:s.user_email})]})]})}),e.jsx("td",{children:e.jsxs("span",{className:`badge bg-${N(s.event)}`,children:[e.jsx("span",{className:"me-1",children:b(s.event)}),s.event]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(h,{size:16,className:"me-2 text-muted"}),p(s.auditable_type)]})}),e.jsx("td",{children:e.jsxs("span",{className:"text-muted",children:["#",s.auditable_id]})}),e.jsx("td",{children:e.jsxs("div",{className:"small",children:[s.old_values&&Object.keys(s.old_values).length>0&&e.jsxs("div",{className:"text-danger",children:[e.jsx("strong",{children:"Old:"})," ",Object.keys(s.old_values).length," fields"]}),s.new_values&&Object.keys(s.new_values).length>0&&e.jsxs("div",{className:"text-success",children:[e.jsx("strong",{children:"New:"})," ",Object.keys(s.new_values).length," fields"]})]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(A,{size:16,className:"me-2 text-muted"}),e.jsx("span",{className:"text-muted small",children:f(s.created_at)})]})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted small",children:s.ip_address||"N/A"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline-primary",children:e.jsx(L,{size:16})})})]},s.id))})]})}):e.jsxs("div",{className:"empty",children:[e.jsx("div",{className:"empty-img",children:e.jsx(x,{size:48,className:"text-muted"})}),e.jsx("p",{className:"empty-title",children:"No audit logs found"}),e.jsx("p",{className:"empty-subtitle text-muted",children:a||l?"Try adjusting your filters to see more results":"System activity will appear here as users interact with the system"})]})})]})]})})]})}export{G as default};
