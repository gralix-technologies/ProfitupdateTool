import{r as n,j as e,L as t,a as i}from"./app-BkeQkwCz.js";import{A as _,c as f}from"./AppLayout-QgBVyLMh.js";import{I as d}from"./IconPlus-Cs3MX6an.js";import{I as z}from"./IconFilter-DpaF_UhO.js";import{I as g}from"./IconSearch-qzSKrpRq.js";import{I as y}from"./IconMath-BtpA-xAv.js";import{I as T}from"./IconEye-BLMw8FPn.js";import{I as F}from"./IconCopy-EHB0SucX.js";import{I as k}from"./IconTrash-DY-55J-g.js";function B({formulas:a,filters:c,products:r}){const[o,m]=n.useState(c.search||""),[h,x]=n.useState(c.product_id||""),[j,p]=n.useState(c.return_type||""),[N,u]=n.useState(c.is_active||""),v=()=>{i.get("/formulas",{search:o,product_id:h,return_type:j,is_active:N},{preserveState:!0,replace:!0})},S=()=>{m(""),x(""),p(""),u(""),i.get("/formulas")},I=async s=>{try{await i.post(`/formulas/${s.id}/duplicate`,{},{onSuccess:()=>{},onError:()=>{}})}catch{}},w=async s=>{if(confirm("Are you sure you want to delete this formula?"))try{await i.delete(`/formulas/${s.id}`,{onSuccess:()=>{},onError:()=>{}})}catch{}},C=s=>({numeric:"bg-blue",text:"bg-green",boolean:"bg-purple",date:"bg-orange"})[s]||"bg-secondary";return e.jsxs(_,{title:"Formulas",children:[e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row g-2 align-items-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"page-pretitle",children:"Analytics"}),e.jsx("h2",{className:"page-title",children:"Formulas"})]}),e.jsx("div",{className:"col-auto ms-auto d-print-none",children:e.jsxs("div",{className:"btn-list",children:[e.jsxs(t,{href:"/formulas/create",className:"btn btn-primary d-none d-sm-inline-block",children:[e.jsx(d,{size:16,className:"me-1"}),"Create Formula"]}),e.jsx(t,{href:"/formulas/create",className:"btn btn-primary d-sm-none btn-icon",children:e.jsx(d,{size:16})})]})})]})})}),e.jsx("div",{className:"page-body",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row row-deck row-cards",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[e.jsx(z,{size:18,className:"me-2"}),"Search & Filter Formulas"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsxs("div",{className:"input-icon",children:[e.jsx("span",{className:"input-icon-addon",children:e.jsx(g,{size:16})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search formulas...",value:o,onChange:s=>m(s.target.value),onKeyPress:s=>s.key==="Enter"&&v()})]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsxs("select",{className:"form-select",value:h,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"",children:"All Products"}),e.jsx("option",{value:"global",children:"Global Formulas"}),r==null?void 0:r.map(s=>e.jsx("option",{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Type"}),e.jsxs("select",{className:"form-select",value:j,onChange:s=>p(s.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"numeric",children:"Numeric"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"date",children:"Date"})]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:N,onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"btn-list",children:[e.jsxs("button",{className:"btn btn-primary",onClick:v,children:[e.jsx(g,{size:16,className:"me-1"}),"Search"]}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:S,children:"Clear"})]})})]})})]})}),a!=null&&a.data&&a.data.length>0?a.data.map(s=>{var l,b;return e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("span",{className:"avatar me-3 bg-primary text-white",children:e.jsx(y,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-0",children:s.name}),e.jsxs("div",{className:"d-flex align-items-center gap-2 mt-1",children:[e.jsx("span",{className:`badge ${C(s.return_type)} text-white`,children:s.return_type}),!s.is_active&&e.jsx("span",{className:"badge bg-secondary text-white",children:"Inactive"})]})]})]}),e.jsx("div",{className:"mb-2",children:e.jsx("code",{className:"bg-light px-2 py-1 rounded small",children:s.expression})}),s.description&&e.jsx("p",{className:"text-muted mb-2",children:s.description}),e.jsxs("div",{className:"text-muted small",children:["Product: ",((l=s.product)==null?void 0:l.name)||"Global"," • Created by: ",((b=s.creator)==null?void 0:b.name)||"Unknown"," •",new Date(s.created_at).toLocaleDateString()]})]}),e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"btn-list",children:[e.jsx(t,{href:`/formulas/${s.id}`,className:"btn btn-white btn-sm",children:e.jsx(T,{size:16})}),e.jsx(t,{href:`/formulas/${s.id}/edit`,className:"btn btn-white btn-sm",children:e.jsx(f,{size:16})}),e.jsx("button",{className:"btn btn-white btn-sm",onClick:()=>I(s),children:e.jsx(F,{size:16})}),e.jsx("button",{className:"btn btn-white btn-sm text-danger",onClick:()=>w(s),children:e.jsx(k,{size:16})})]})})]})})})},s.id)}):e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"empty",children:[e.jsx("div",{className:"empty-img",children:e.jsx(y,{size:48,className:"text-muted"})}),e.jsx("p",{className:"empty-title",children:"No formulas found"}),e.jsx("p",{className:"empty-subtitle text-muted",children:"Get started by creating your first custom formula"}),e.jsx("div",{className:"empty-action",children:e.jsxs(t,{href:"/formulas/create",className:"btn btn-primary",children:[e.jsx(d,{size:16,className:"me-1"}),"Create Formula"]})})]})})})}),(a==null?void 0:a.links)&&a.data&&a.data.length>0&&e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-footer d-flex align-items-center",children:[e.jsxs("p",{className:"m-0 text-muted",children:["Showing ",e.jsx("span",{children:a.from||1})," to ",e.jsx("span",{children:a.to||a.data.length})," of ",e.jsx("span",{children:a.total||a.data.length})," entries"]}),e.jsx("ul",{className:"pagination m-0 ms-auto",children:a.links.map((s,l)=>e.jsx("li",{className:`page-item ${s.active?"active":""} ${s.url?"":"disabled"}`,children:s.url?e.jsx(t,{href:s.url,className:"page-link",dangerouslySetInnerHTML:{__html:s.label}}):e.jsx("span",{className:"page-link",dangerouslySetInnerHTML:{__html:s.label}})},l))})]})})})]})})})]})}export{B as default};
