import{r as N,j as e,L as d}from"./app-BkeQkwCz.js";import{u as g,A as f,a as y}from"./AppLayout-QgBVyLMh.js";import{u as C}from"./useFormWithCsrf-CQ_fNGy5.js";import{I as _}from"./IconDownload-DpSVhOrW.js";import{I as m}from"./IconUpload-DI1O2urB.js";import{I as k}from"./IconArrowLeft-0rt3x0IP.js";import{I as w}from"./IconDeviceFloppy-BoO_tT2I.js";function A({riskLevels:p}){const[r,x]=N.useState(!1),{showSuccess:h,showError:o}=g(),{data:a,setData:c,post:u,processing:t,errors:l}=C({customer_id:"",name:"",email:"",phone:"",branch_code:"",risk_level:"",is_active:!0,total_loans_outstanding:0,total_deposits:0,npl_exposure:0,profitability:0,demographics:{age:"",gender:"",occupation:"",address:"",city:"",country:"Zambia"}}),v=s=>{s.preventDefault(),console.log("Submitting customer data:",a),u("/customers",{onStart:()=>{console.log("Customer form submission started...")},onProgress:()=>{console.log("Customer form submission in progress...")},onSuccess:i=>{console.log("Customer form submission successful:",i),h("Customer created successfully!")},onError:i=>{if(console.error("Customer form submission error:",i),console.error("Error type:",typeof i),console.error("Error details:",JSON.stringify(i,null,2)),typeof i=="object"&&i!==null)if(Array.isArray(i))o(i.join(", "),"Validation Error");else{const n=Object.values(i).flat();o(n.join(", "),"Validation Error")}else o(typeof i=="string"?i:"Failed to create customer. Please try again.")},onFinish:()=>{console.log("Customer form submission finished")}})},j=s=>{s.preventDefault(),u("/customers/bulk-upload",{onSuccess:()=>{h("Customers uploaded successfully!")},onError:i=>{if(typeof i=="object"&&i!==null){const n=Object.values(i).flat();o(n.join(", "),"Upload Error")}else o(typeof i=="string"?i:"Failed to upload customers. Please try again.")}})},b=()=>{const s=document.createElement("a");s.href="/customers/download-template",s.download="customer_bulk_upload_template.csv",s.click()};return e.jsxs(f,{title:"Create Customer",children:[e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row g-2 align-items-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("nav",{"aria-label":"breadcrumb",children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx(d,{href:"/customers",children:"Customers"})}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Create"})]})}),e.jsx("div",{className:"page-pretitle",children:"Customer Management"}),e.jsx("h2",{className:"page-title",children:"Create New Customer"})]}),e.jsx("div",{className:"col-auto ms-auto d-print-none",children:e.jsxs("div",{className:"btn-list",children:[e.jsxs("button",{type:"button",className:"btn btn-outline-primary",onClick:b,children:[e.jsx(_,{size:16,className:"me-1"}),"Download Template"]}),e.jsxs("button",{type:"button",className:`btn ${r?"btn-primary":"btn-outline-secondary"}`,onClick:()=>x(!r),children:[e.jsx(m,{size:16,className:"me-1"}),"Bulk Upload"]}),e.jsxs(d,{href:"/customers",className:"btn",children:[e.jsx(k,{size:16,className:"me-1"}),"Back to Customers"]})]})})]})})}),e.jsx("div",{className:"page-body",children:e.jsx("div",{className:"container-fluid px-3",children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col-12",children:[r&&e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[e.jsx(m,{size:18,className:"me-2"}),"Bulk Upload Customers"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-lg-8 col-xl-9",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Upload CSV File"}),e.jsx("input",{type:"file",className:"form-control form-control-lg",accept:".csv",onChange:s=>c("csv_file",s.target.files[0])}),e.jsx("div",{className:"form-text",children:"Upload a CSV file with customer data. Download the template for the correct format."})]})}),e.jsx("div",{className:"col-lg-4 col-xl-3",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Â "}),e.jsxs("button",{type:"button",className:"btn btn-primary btn-lg w-100",onClick:j,disabled:t,children:[e.jsx(m,{size:16,className:"me-1"}),"Upload Customers"]})]})})]})})]}),e.jsx("form",{onSubmit:v,children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[e.jsx(y,{size:18,className:"me-2"}),"Customer Information"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label required",children:"Customer ID"}),e.jsx("input",{type:"text",className:`form-control ${l.customer_id?"is-invalid":""}`,value:a.customer_id,onChange:s=>c("customer_id",s.target.value),placeholder:"Enter unique customer ID"}),l.customer_id&&e.jsx("div",{className:"invalid-feedback",children:l.customer_id})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label required",children:"Full Name"}),e.jsx("input",{type:"text",className:`form-control ${l.name?"is-invalid":""}`,value:a.name,onChange:s=>c("name",s.target.value),placeholder:"Enter customer full name"}),l.name&&e.jsx("div",{className:"invalid-feedback",children:l.name})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",className:`form-control ${l.email?"is-invalid":""}`,value:a.email,onChange:s=>c("email",s.target.value),placeholder:"Enter email address"}),l.email&&e.jsx("div",{className:"invalid-feedback",children:l.email})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Phone Number"}),e.jsx("input",{type:"text",className:`form-control ${l.phone?"is-invalid":""}`,value:a.phone,onChange:s=>c("phone",s.target.value),placeholder:"Enter phone number"}),l.phone&&e.jsx("div",{className:"invalid-feedback",children:l.phone})]})})]}),e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-lg-4 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label required",children:"Branch"}),e.jsx("input",{type:"text",className:`form-control ${l.branch_code?"is-invalid":""}`,value:a.branch_code,onChange:s=>c("branch_code",s.target.value),placeholder:"Enter branch code (e.g., LUS001, NDL001)"}),l.branch_code&&e.jsx("div",{className:"invalid-feedback",children:l.branch_code})]})}),e.jsx("div",{className:"col-lg-4 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label required",children:"Risk Level"}),e.jsxs("select",{className:`form-select ${l.risk_level?"is-invalid":""}`,value:a.risk_level,onChange:s=>c("risk_level",s.target.value),children:[e.jsx("option",{value:"",children:"Select Risk Level"}),p.map(s=>e.jsx("option",{value:s,children:s},s))]}),l.risk_level&&e.jsx("div",{className:"invalid-feedback",children:l.risk_level})]})}),e.jsx("div",{className:"col-lg-4 col-md-12",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("div",{className:"form-check form-switch mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a.is_active,onChange:s=>c("is_active",s.target.checked)}),e.jsx("label",{className:"form-check-label",children:a.is_active?"Active":"Inactive"})]})]})})]}),e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12",children:e.jsx("h4",{className:"text-dark fw-bold mb-3",children:"Financial Metrics (Optional)"})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Total Loans Outstanding"}),e.jsx("input",{type:"number",step:"0.01",className:`form-control ${l.total_loans_outstanding?"is-invalid":""}`,value:a.total_loans_outstanding,onChange:s=>c("total_loans_outstanding",parseFloat(s.target.value)||0),placeholder:"0.00"}),l.total_loans_outstanding&&e.jsx("div",{className:"invalid-feedback",children:l.total_loans_outstanding})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Total Deposits"}),e.jsx("input",{type:"number",step:"0.01",className:`form-control ${l.total_deposits?"is-invalid":""}`,value:a.total_deposits,onChange:s=>c("total_deposits",parseFloat(s.target.value)||0),placeholder:"0.00"}),l.total_deposits&&e.jsx("div",{className:"invalid-feedback",children:l.total_deposits})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"NPL Exposure"}),e.jsx("input",{type:"number",step:"0.01",className:`form-control ${l.npl_exposure?"is-invalid":""}`,value:a.npl_exposure,onChange:s=>c("npl_exposure",parseFloat(s.target.value)||0),placeholder:"0.00"}),l.npl_exposure&&e.jsx("div",{className:"invalid-feedback",children:l.npl_exposure})]})}),e.jsx("div",{className:"col-lg-3 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Profitability"}),e.jsx("input",{type:"number",step:"0.01",className:`form-control ${l.profitability?"is-invalid":""}`,value:a.profitability,onChange:s=>c("profitability",parseFloat(s.target.value)||0),placeholder:"0.00"}),l.profitability&&e.jsx("div",{className:"invalid-feedback",children:l.profitability})]})})]}),e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12",children:e.jsx("h4",{className:"text-dark fw-bold mb-3",children:"Demographics (Optional)"})}),e.jsx("div",{className:"col-lg-2 col-md-4 col-sm-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Age"}),e.jsx("input",{type:"number",className:"form-control",value:a.demographics.age,onChange:s=>c("demographics",{...a.demographics,age:s.target.value}),placeholder:"Age"})]})}),e.jsx("div",{className:"col-lg-2 col-md-4 col-sm-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Gender"}),e.jsxs("select",{className:"form-select",value:a.demographics.gender,onChange:s=>c("demographics",{...a.demographics,gender:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]})}),e.jsx("div",{className:"col-lg-4 col-md-8",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Occupation"}),e.jsx("input",{type:"text",className:"form-control",value:a.demographics.occupation,onChange:s=>c("demographics",{...a.demographics,occupation:s.target.value}),placeholder:"Occupation"})]})}),e.jsx("div",{className:"col-lg-4 col-md-12",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Address"}),e.jsx("input",{type:"text",className:"form-control",value:a.demographics.address,onChange:s=>c("demographics",{...a.demographics,address:s.target.value}),placeholder:"Street address"})]})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-lg-6 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:a.demographics.city,onChange:s=>c("demographics",{...a.demographics,city:s.target.value}),placeholder:"City"})]})}),e.jsx("div",{className:"col-lg-6 col-md-6",children:e.jsxs("div",{className:"mb-0",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:a.demographics.country,onChange:s=>c("demographics",{...a.demographics,country:s.target.value}),placeholder:"Country"})]})})]})]}),e.jsx("div",{className:"card-footer text-end",children:e.jsxs("div",{className:"d-flex",children:[e.jsx(d,{href:"/customers",className:"btn btn-link",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary ms-auto",disabled:t,children:[e.jsx(w,{size:16,className:"me-1"}),t?"Creating...":"Create Customer"]})]})})]})})]})})})})]})}export{A as default};
